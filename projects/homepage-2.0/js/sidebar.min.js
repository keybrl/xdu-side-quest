var lat="34.1273045",lon="108.8269963";function getWeather(){if(!network_state){return getNetState()}$("#weather_img").html('<span class="icon-spiner icon-spin" style="font-size: 5vw;"></span>');if(lat==""||lon==""){$("#temp").text("99");$("#temp1").text("99");$("#temp2").text("99");$("#weather").text("青蛙雨");$("#city").html('魔都 <span class="icon-map-marker"></span>').attr("title","Magical City\nClick to Reload");$("#weather-main").attr("title","Update: yyyy-mm-dd HH:MM:SS\nClick to Reload");$("#weather_img").html('<span class="icon-refresh" style="font-size: 5vw;"></span>');return getLocation()}$.ajax({url:"http://aliv2.data.moji.com/whapi/json/aliweather/briefforecast3days",type:"POST",data:{lat:lat,lon:lon},beforeSend:function(a){a.setRequestHeader("Authorization","APPCODE a9dab280ccd341749f034d2bc338dcf9")},success:function(a){a=$.parseJSON(a);$("#temp1").text(a.data["forecast"][0]["tempDay"]);$("#temp2").text(a.data["forecast"][0]["tempNight"])},error:function(){$("#temp1").text("99");$("#temp2").text("99")}});$.ajax({url:"http://aliv2.data.moji.com/whapi/json/aliweather/briefcondition",type:"POST",data:{lat:lat,lon:lon},beforeSend:function(a){a.setRequestHeader("Authorization","APPCODE a9dab280ccd341749f034d2bc338dcf9")},success:function(a){a=$.parseJSON(a);$("#temp").text(a.data["condition"]["temp"]);$("#weather").text(a.data["condition"]["condition"]);$("#city").html(a.data["city"]["name"]+' <span class="icon-map-marker"></span>').attr("title",a.data["city"]["pname"]+" "+a.data["city"]["name"]+"\nClick to Reload");$("#weather-main").attr("title","Update: "+a.data["condition"]["updatetime"]+"\nClick to Reload");$("#weather_img").html('<img src="./img/weather/'+a.data["condition"]["condition"]+'.png" class="img-responsive">')},error:function(){$("#temp").text("99");$("#weather").text("青蛙雨");$("#city").html('魔都 <span class="icon-map-marker"></span>').attr("title","Magical City\nClick to Reload");$("#weather-main").attr("title","Update: yyyy-mm-dd HH:MM:SS\nClick to Reload");$("#weather_img").html('<span class="icon-refresh" style="font-size: 5vw;"></span>')}})}function getTime(){var d=new Date();var f=d.getMonth();var c=d.getDate();var b=d.getDay();var a=d.getHours();var e=d.getMinutes();var g=d.getSeconds();$("#hours").text(a);if(e<10){e="0"+e}$("#minutes").text(e);if(g<10){g="0"+g}$("#seconds").text(g);if(b===0){b="Sunday"}else{if(b===1){b="Monday"}else{if(b===2){b="Tuesday"}else{if(b===3){b="Wednesday"}else{if(b===4){b="Thursday"}else{if(b===5){b="Friday"}else{if(b===6){b="Saturday"}}}}}}}$("#day").text(b);if(f===0){f="Jan."}else{if(f===1){f="Feb."}else{if(f===2){f="Mar."}else{if(f===3){f="Apr."}else{if(f===4){f="May"}else{if(f===5){f="June"}else{if(f===6){f="July"}else{if(f===7){f="Aug."}else{if(f===8){f="Sept."}else{if(f===9){f="Oct."}else{if(f===10){f="Nov."}else{if(f===11){f="Dec."}}}}}}}}}}}}$("#month").text(f);$("#date").text(c);setTimeout("getTime()",100)}function getNetState(){if(!network_state){$("#net-switch").attr("class","icon-off online");setTimeout(function(){$("#net-switch").attr("class","icon-off offline");setTimeout(function(){$("#net-switch").attr("class","icon-off online");setTimeout(function(){$("#net-switch").attr("class","icon-off offline");setTimeout(function(){$("#net-switch").attr("class","icon-off online");setTimeout(function(){$("#net-switch").attr("class","icon-off offline")},300)},300)},300)},300)},300)}else{var b=$("#netState_refresh");b.addClass("icon-spin");$("#net-switch").attr("class","icon-off offline");$("#ip_address").text("xxx.xxx.xxx.xxx");$("#net_state").text("Testing...");$.ajax({url:"http://39.108.75.56/ip_address",success:function(d){$("#ip_address").text(d);$("#net_state").text("Internet Accessible");$("#net-switch").attr("class","icon-off online")},error:function(){$("#net-switch").attr("class","icon-off noInternet");$("#net_state").text("Offline")}});var c=$("#gfw_try");var a=$("#gfw_state");c.html("");gfw_state=0;c.html('<img src="https://www.google.com.hk/images/branding/googlelogo/2x/googlelogo_color_120x44dp.png" onload="gfw_state = 1;">');setTimeout(function(){if(gfw_state){a.text("The real internet!")}else{a.text("The limited internet!")}b.removeClass("icon-spin")},5000)}}function switch_net(){if(!network_state){$("#net-switch").attr("class","icon-off online");network_state=1;getNetState()}else{network_state=0;$("#net-switch").attr("class","icon-off offline");$("#ip_address").text("xxx.xxx.xxx.xxx");$("#net_state").text("Offline")}}function getLocation(){if(!network_state){return getNetState()}var a={enableHighAccuracy:true,maximumAge:1000};if(navigator.geolocation){navigator.geolocation.getCurrentPosition(c,b,a)}else{}function c(d){lat=String(d.coords.latitude);lon=String(d.coords.longitude);return getWeather()}function b(d){switch(d.code){case 1:alert("位置服务被拒绝");break;case 2:alert("暂时获取不到位置信息");break;case 3:alert("获取信息超时");break;case 4:alert("未知错误");break}}};